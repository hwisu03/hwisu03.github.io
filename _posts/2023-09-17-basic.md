# 데이터프레임 다루기(기초)
### 데이터프레임 생성하기
```python
#직접 데이터프레임 작성
import numpy as np
import pandas as pd
my_df = pd.DataFrame(data=np.array([[1, 2, 3], [4, 5, 6]]), index=range(1,3), columns=['A','B','C'])
print(my_df)
```

       A  B  C
    1  1  2  3
    2  4  5  6
    
<br>

```python
#2D어레이를 데이터프레임으로 변환
import numpy as np
import pandas as pd
my_2darray = np.array([[1,2,3],[4,5,6]])
print(pd.DataFrame(my_2darray))
```

       0  1  2
    0  1  2  3
    1  4  5  6
    

<br>

```python
#dictionary를 데이터프레임으로 변환
import numpy as np
import pandas as pd
my_dict = {'a': ['1', '3'], 'b': ['1', '2'], 'c': ['2', '4']}
print(pd.DataFrame(my_dict))
```

       a  b  c
    0  1  1  2
    1  3  2  4
    

<br>

```python
#Series를 데이터프레임으로 변환
import numpy as np
import pandas as pd
my_series = pd.Series({'United Kingdom':'London', 'India':'New Delhi', 'United States':'Washington', 'Belgium':'Brussels'})
print(pd.DataFrame(my_series))
```

                             0
    United Kingdom      London
    India            New Delhi
    United States   Washington
    Belgium           Brussels
    

<br>

```python
#외부 파일로 부터 불러오기
#R의 iris 데이터셋을 csv파일로 불러왔습니다.
import pandas as pd
df = pd.read_csv('iris.csv', sep = ',')
print(df.head(3))
```

       Unnamed: 0  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width Species
    0           1           5.1          3.5           1.4          0.2  setosa
    1           2           4.9          3.0           1.4          0.2  setosa
    2           3           4.7          3.2           1.3          0.2  setosa
    
<br>

### 데이터프레임 살펴보기
```python
#메타데이터 확인하기
import pandas as pd
my_df = pd.DataFrame(data=np.array([[1, 2, 3], [4, 5, 6]]), index=range(1,3), columns=['A','B','C'])
my_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2 entries, 1 to 2
    Data columns (total 3 columns):
     #   Column  Non-Null Count  Dtype
    ---  ------  --------------  -----
     0   A       2 non-null      int32
     1   B       2 non-null      int32
     2   C       2 non-null      int32
    dtypes: int32(3)
    memory usage: 156.0 bytes
    

<br>

```python
#출력 제한 걸기
pd.options.display.max_rows = 20  
pd.set_option('display.min_rows', 5)

df = pd.read_csv('iris.csv', sep = ',').iloc[:,0:7]
print(df)
```

         Unnamed: 0  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width  \
    0             1           5.1          3.5           1.4          0.2   
    1             2           4.9          3.0           1.4          0.2   
    ..          ...           ...          ...           ...          ...   
    148         149           6.2          3.4           5.4          2.3   
    149         150           5.9          3.0           5.1          1.8   
    
           Species  
    0       setosa  
    1       setosa  
    ..         ...  
    148  virginica  
    149  virginica  
    
    [150 rows x 6 columns]
    


<br>

```python
#데이터프레임의 형태
df = pd.DataFrame({'A':[11,21,31], 'B':[12,22,32], 'C':[13,23,33]}, index=['1st','2nd','3rd'])
print(df.shape) 
print(len(df.index)) 
```

    (3, 3)
    3
    

<br>

```python
#데이터프레임 데이터 확인하기
df = pd.DataFrame({'A':[11,21,31], 'B':[12,22,32], 'C':[13,23,33]}
                  , index=['1st','2nd','3rd'])
print(df)
display(df)
```

          A   B   C
    1st  11  12  13
    2nd  21  22  23
    3rd  31  32  33
    


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1st</th>
      <td>11</td>
      <td>12</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2nd</th>
      <td>21</td>
      <td>22</td>
      <td>23</td>
    </tr>
    <tr>
      <th>3rd</th>
      <td>31</td>
      <td>32</td>
      <td>33</td>
    </tr>
  </tbody>
</table>
</div>


<br>

### 데이터 추가하기와 삭제하기
```python
#행 추가하기
df = pd.DataFrame({'A':[11,21,31], 'B':[12,22,32], 'C':[13,23,33]}, index=['1st','2nd','3rd'])
df.loc['4th'] = [41, 42, 43]
df.loc['8th'] = [81, 82, 83]
print(df)
```

          A   B   C
    1st  11  12  13
    2nd  21  22  23
    3rd  31  32  33
    4th  41  42  43
    8th  81  82  83
    

<br>

```python
#열 추가하기
df['D'] = [14, 24, 34, 44, 84]
print(df)
```

          A   B   C   D
    1st  11  12  13  14
    2nd  21  22  23  24
    3rd  31  32  33  34
    4th  41  42  43  44
    8th  81  82  83  84
    

<br>

```python
#열 삭제하기
df.drop('D', axis = 1, inplace = True) 
print(df)
```

          A   B   C
    1st  11  12  13
    2nd  21  22  23
    3rd  31  32  33
    4th  41  42  43
    8th  81  82  83
    

<br>

```python
#행 삭제하기
df.drop(['4th','8th'], axis = 0, inplace = True)
print(df)
```

          A   B   C
    1st  11  12  13
    2nd  21  22  23
    3rd  31  32  33
    

<br>

### 인덱싱과 슬라이싱
```python
#열 선택
df = pd.DataFrame({'A':[11,21,31], 'B':[12,22,32], 'C':[13,23,33]}, index=['1st','2nd','3rd'])
print(df['C'])
print(df[['A','C']])
```

    1st    13
    2nd    23
    3rd    33
    Name: C, dtype: int64
          A   C
    1st  11  13
    2nd  21  23
    3rd  31  33
    

<br>

```python
#인덱스 선택
print(df.loc['1st'])
print(df.loc[['1st','3rd']])
print(df.loc['1st':'2nd'])
print(df.loc[:,'B':'C'])
```

    A    11
    B    12
    C    13
    Name: 1st, dtype: int64
          A   B   C
    1st  11  12  13
    3rd  31  32  33
          A   B   C
    1st  11  12  13
    2nd  21  22  23
          B   C
    1st  12  13
    2nd  22  23
    3rd  32  33
    

<br>

```python
#절대위치선택
print(df.iloc[0])
print(df.iloc[[0,2]])
print(df.iloc[0:3]) 
print(df.iloc[:,1:3]) 
```

    A    11
    B    12
    C    13
    Name: 1st, dtype: int64
          A   B   C
    1st  11  12  13
    3rd  31  32  33
          A   B   C
    1st  11  12  13
    2nd  21  22  23
    3rd  31  32  33
          B   C
    1st  12  13
    2nd  22  23
    3rd  32  33
    

<br>


### 탐색하여 슬라이싱
```python
#Dataframe의 변수를 이용하여 슬라이싱
df = pd.DataFrame({'A':[11,21,31], 'B':[12,22,32], 'C':[13,23,33]}, index=['1st','2nd','3rd'])
print(df[df.C<30])
print(df.loc[lambda x: x.C<30])
print(df.loc[df['C']<30, ['A','B']])
```

          A   B   C
    1st  11  12  13
    2nd  21  22  23
          A   B   C
    1st  11  12  13
    2nd  21  22  23
          A   B
    1st  11  12
    2nd  21  22
    
## 메서드 결합
```python
df = pd.DataFrame({'name':['Yang','Kim','Park','choi','Son','Kim'], 'sex':['M','M','F','M','F','M'], 'age':[20,20,40,20,15,20], 'class':['DS','SL','DS','PP','SL','DV'], 'car': ['yes','no','yes','no','yes','no']})
print(df)
```

       name sex  age class  car
    0  Yang   M   20    DS  yes
    1   Kim   M   20    SL   no
    2  Park   F   40    DS  yes
    3  choi   M   20    PP   no
    4   Son   F   15    SL  yes
    5   Kim   M   20    DV   no
    
<br> 


```python
#class별 수강학생 수
df.groupby(by='class')['name'].count()
```




    class
    DS    2
    DV    1
    PP    1
    SL    2
    Name: name, dtype: int64


<br>

```python
#학생별 수강 교과목의 수
df.groupby(by=['name','sex','age'])['class'].count()
```




    name  sex  age
    Kim   M    20     2
    Park  F    40     1
    Son   F    15     1
    Yang  M    20     1
    choi  M    20     1
    Name: class, dtype: int64


<br>

```python
#학생별 수강교과목이 2개 이상인 데이터만 필터링
df.groupby(by=['name','sex','age']).filter(lambda x: len(x)>=2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>sex</th>
      <th>age</th>
      <th>class</th>
      <th>car</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Kim</td>
      <td>M</td>
      <td>20</td>
      <td>SL</td>
      <td>no</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Kim</td>
      <td>M</td>
      <td>20</td>
      <td>DV</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>


<br>

```python
#2 class이상 수강하는 학생의 이름
df.groupby(by=['name','sex','age']).filter(lambda x: len(x)>=2)['name'].unique()
```




    array(['Kim'], dtype=object)



<br>

```python
 #2 class이상 수강하는 학생의 평균나이
(df.groupby(by=['name','sex','age']).filter(lambda x: len(x)>=2)[['name','age']].drop_duplicates()['age'].mean())
```




    20.0



## pandas 그래프
```python
import pandas as pd

df1 = pd.DataFrame(np.random.rand(6))
print(df1.head())

df2 = pd.DataFrame(np.random.rand(6))
print(df2.head())
```

              0
    0  0.955951
    1  0.160504
    2  0.545688
    3  0.630906
    4  0.228130
              0
    0  0.970468
    1  0.034785
    2  0.364817
    3  0.278715
    4  0.079672
    

<br> 

```python
import matplotlib.pyplot as plt
df1.plot()
df2.plot()
plt.title("random number df1")
plt.show()
```


    
![png](https://drive.google.com/uc?id=1RvZGKvYaAPAUPZolG9dSN_8_y01QZ4sA)
    



    
![png](https://drive.google.com/uc?id=1rw8wgt_KB1J01zuJ9V8SfaM6mkwEq_UI)
    


<br> 

```python
df = pd.concat([df1,df2], axis=1)
df.columns = ['df1', 'df2']
print(df.head())
df.plot()
```

            df1       df2
    0  0.129720  0.379755
    1  0.219437  0.975979
    2  0.326108  0.563658
    3  0.264226  0.317731
    4  0.974992  0.375947
    




    <Axes: >




    
![png](https://drive.google.com/uc?id=1lnCRiBTW1LdtP7kM4iTJJ9SkS73qF7Bw)
    


<br> 

```python
df.plot(kind='barh')
```




    <Axes: >




    
![png](https://drive.google.com/uc?id=1hTXFfFTeociDEFZiKaRd7Y7N2iljJQ52)
    


<br> 

```python
df.plot(kind='area')
```




    <Axes: >




    
![png](https://drive.google.com/uc?id=1H4KaeeCVHiFkk3Hnz1Br7MDrkqVWUTCY)
    



<br>

```python
df.plot(kind='scatter', x='df1', y='df2')
```




    <Axes: xlabel='df1', ylabel='df2'>




    
![png](https://drive.google.com/uc?id=1lQ37rFkCCJslpHQIbyrveSivP5rgt_cz)
    


<br>

```python
import matplotlib.pyplot as plt

fig, ax = plt.subplots()

fruits = ['apple', 'blueberry','Kiwi', 'cherry', 'orange','Melon']
counts = [40, 100, 30, 55,60,70]
bar_labels = ['red', 'blue','green', 'red', 'orange','green']
bar_colors = ['tab:red', 'tab:blue','tab:green', 'tab:red', 'tab:orange', 'tab:green']

ax.bar(fruits, counts, label=bar_labels, color=bar_colors)

ax.set_ylabel('fruit supply')
ax.set_title('Fruit supply by kind and color')
ax.legend(title='Fruit color')

plt.show()
```


    
![png](https://drive.google.com/uc?id=1qycZyWITQib_f2Z3m1STOJY2moPAPY1E)
    


<br> 

```python
import matplotlib.pyplot as plt

data = {'apple': 10, 'orange': 15, 'lemon': 5, 'lime': 20}
names = list(data.keys())
values = list(data.values())

fig, axs = plt.subplots(1, 3, figsize=(9, 3), sharey=True)
axs[0].bar(names, values)
axs[1].scatter(names, values)
axs[2].plot(names, values)
fig.suptitle('Categorical Plotting')
```




    Text(0.5, 0.98, 'Categorical Plotting')




    
![png](https://drive.google.com/uc?id=1I5fZkdMToZG_XxzUbaHs8Yg8zZiQeBoC)
    


<br> 

```python
import numpy as np
import matplotlib.pyplot as plt

# Fixing random state for reproducibility
np.random.seed(19680801)

dt = 0.01
t = np.arange(0, 50, dt)
nse1 = np.random.randn(len(t))                
nse2 = np.random.randn(len(t))                

s1 = np.sin(2 * np.pi * 8 * t) + nse1
s2 = np.sin(2 * np.pi * 8 * t) + nse2

fig, axs = plt.subplots(2, 1)
axs[0].plot(t, s1, t, s2)
axs[0].set_xlim(0, 2)
axs[0].set_xlabel('rate')
axs[0].set_ylabel('s1 and s2')
axs[0].grid(True)

cxy, f = axs[1].cohere(s1, s2, 256, 1. / dt)
axs[1].set_ylabel('Coherence')

fig.tight_layout()
plt.show()
```


    
![png](https://drive.google.com/uc?id=1yeTZIMtwiHzxDCXQaAp-8kh12ERiWB3f)
    


<br> 

```python
import matplotlib.pyplot as plt
import pandas as pd

ts = pd.Series(np.random.randn(1000), index=pd.date_range("1/1/2000", periods=1000))
ts = ts.cumsum()
ts.plot()
```




    <Axes: >




    
![png](https://drive.google.com/uc?id=1v_EgKsFORmB5m1ippAPAGiEvLpyyTtWQ)
    


<br> 

```python
df = pd.DataFrame(np.random.randn(1000, 4), index=ts.index, columns=list("ABCD"))
df = df.cumsum()
plt.figure()
df.plot()
```




    <Axes: >




    <Figure size 640x480 with 0 Axes>



    
![png](https://drive.google.com/uc?id=1ICzLNEbcSLzlwyg7rBpO1XQXCf4lWxms)
    


<br> 

```python
df2 = pd.DataFrame(np.random.rand(10, 4), columns=["a", "b", "c", "d"])
df2.plot.bar()
```




    <Axes: >




    
![png](https://drive.google.com/uc?id=1RaiOQx7LWgGe42SJBBDk-Rbu8eq85_tC)
    


<br> 

```python
df2.plot.bar(stacked=True)
```




    <Axes: >




    
![png](https://drive.google.com/uc?id=1-Hdyn5h7suNwRHnOej9GWI1f9RtP_lSm)
    


<br> 

```python
df2.plot.barh(stacked=True)
```




    <Axes: >




    
![png](https://drive.google.com/uc?id=1cYS5F3EMrMn__wDtC9C1s9BTCl7IE27C)
    


<br> 

```python
df4 = pd.DataFrame(
    {"a": np.random.randn(1000) + 2, "b": np.random.randn(1000), "c": np.random.randn(1000) - 1,},columns=["a", "b", "c"],)
plt.figure()
df4.plot.hist(alpha=0.5)
```




    <Axes: ylabel='Frequency'>




    <Figure size 640x480 with 0 Axes>



    
![png](https://drive.google.com/uc?id=18qxpyapbXN2fIUyL3ulxs32uHsNSRESp)
    


<br> 

```python
df = pd.DataFrame(np.random.rand(10, 5), columns=["A", "B", "C", "D", "E"])
df.plot.box()
```




    <Axes: >




    
![png](https://drive.google.com/uc?id=1KhQK4V4oMA_64w_pWmagjOrzB4itxAKS)
    
